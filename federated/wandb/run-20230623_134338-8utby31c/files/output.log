




epoch: 11, loss: 0.60, time: 0.63:   3%|▉                                  | 11/400 [00:09<05:11,  1.25it/s]




epoch: 21, loss: 0.58, time: 0.86:   5%|█▊                                 | 21/400 [00:17<05:02,  1.25it/s]




epoch: 30, loss: 0.55, time: 0.88:   8%|██▋                                | 30/400 [00:24<05:41,  1.08it/s]




epoch: 40, loss: 0.54, time: 0.87:  10%|███▌                               | 40/400 [00:33<05:13,  1.15it/s]




epoch: 51, loss: 0.51, time: 0.57:  13%|████▍                              | 51/400 [00:41<04:02,  1.44it/s]



epoch: 59, loss: 0.50, time: 0.59:  15%|█████▏                             | 59/400 [00:47<03:37,  1.56it/s]




epoch: 70, loss: 0.53, time: 0.72:  18%|██████▏                            | 70/400 [00:55<04:06,  1.34it/s]



epoch: 79, loss: 0.50, time: 0.70:  20%|██████▉                            | 79/400 [01:01<03:38,  1.47it/s]




epoch: 90, loss: 0.50, time: 1.03:  22%|███████▊                           | 89/400 [01:09<04:00,  1.29it/s]





epoch: 101, loss: 0.49, time: 0.81:  25%|████████▎                        | 101/400 [01:19<04:13,  1.18it/s]



epoch: 110, loss: 0.47, time: 0.68:  28%|█████████                        | 110/400 [01:26<03:36,  1.34it/s]




epoch: 120, loss: 0.50, time: 0.65:  30%|█████████▉                       | 120/400 [01:33<03:29,  1.34it/s]




epoch: 131, loss: 0.50, time: 0.90:  33%|██████████▊                      | 131/400 [01:41<03:29,  1.28it/s]




epoch: 141, loss: 0.51, time: 0.65:  35%|███████████▋                     | 141/400 [01:49<03:34,  1.21it/s]




epoch: 151, loss: 0.49, time: 0.90:  38%|████████████▍                    | 151/400 [01:58<03:39,  1.14it/s]




epoch: 160, loss: 0.51, time: 0.69:  40%|█████████████▏                   | 160/400 [02:05<03:23,  1.18it/s]




epoch: 170, loss: 0.53, time: 0.70:  42%|██████████████                   | 170/400 [02:13<03:13,  1.19it/s]




epoch: 180, loss: 0.51, time: 0.67:  45%|██████████████▊                  | 180/400 [02:21<03:00,  1.22it/s]




epoch: 189, loss: 0.52, time: 0.87:  47%|███████████████▌                 | 189/400 [02:29<02:56,  1.20it/s]




epoch: 200, loss: 0.51, time: 0.63:  50%|████████████████▍                | 199/400 [02:38<02:56,  1.14it/s]




epoch: 210, loss: 0.51, time: 0.53:  52%|█████████████████▎               | 210/400 [02:46<02:31,  1.25it/s]




epoch: 221, loss: 0.49, time: 0.63:  55%|██████████████████▏              | 221/400 [02:54<02:07,  1.41it/s]




epoch: 231, loss: 0.52, time: 0.87:  58%|███████████████████              | 231/400 [03:02<02:24,  1.17it/s]




epoch: 241, loss: 0.50, time: 0.77:  60%|███████████████████▉             | 241/400 [03:10<02:19,  1.14it/s]





epoch: 252, loss: 0.50, time: 0.73:  63%|████████████████████▊            | 252/400 [03:20<02:00,  1.23it/s]




epoch: 261, loss: 0.49, time: 0.78:  65%|█████████████████████▌           | 261/400 [03:28<02:09,  1.08it/s]



epoch: 271, loss: 0.51, time: 0.73:  68%|██████████████████████▎          | 271/400 [03:36<01:54,  1.13it/s]




epoch: 280, loss: 0.49, time: 0.63:  70%|███████████████████████          | 279/400 [03:44<01:37,  1.24it/s]
Traceback (most recent call last):
  File "src/main.py", line 93, in <module>
    main()
  File "src/main.py", line 74, in main
    trained_model = run_server(dataset, num_clients=args.c, epochs=args.epochs,
  File "/home/abenzaamia/MLP/federated/src/server.py", line 39, in run_server
    trained_weights = training_process(server_model, clients, num_clients, epochs, local_epochs, dataset, args)
  File "/home/abenzaamia/MLP/federated/src/fedmlp/train.py", line 79, in training_process
    hr, ndcg, mapk, mark = evaluate_model(server_model, users, items, negatives)
  File "/home/abenzaamia/MLP/federated/src/fedmlp/eval.py", line 108, in evaluate_model
    pred, _ = model(user_input, item_input_gpu)
  File "/home/abenzaamia/.venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/abenzaamia/MLP/federated/src/fedmlp/models.py", line 31, in forward
    mlp_user_latent = torch.nn.Flatten()(self.mlp_embedding_user(user_input))
  File "/home/abenzaamia/.venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/abenzaamia/.venv/lib/python3.8/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/abenzaamia/.venv/lib/python3.8/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
KeyboardInterrupt